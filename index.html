<!doctype html><html lang=tr><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noindex, nofollow"><title>Oyun Durumum</title><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css rel=stylesheet><style>:root{--primary:#8a2be2;--secondary:#ff5722;--dark:#121212;--light:#f0f0f0;--success:#4caf50;--danger:#f44336;--warning:#ff9800;--card-bg:rgba(30, 30, 30, 0.6)}*{margin:0;padding:0;box-sizing:border-box;font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif}body{background-color:var(--dark);color:var(--light);min-height:100vh;display:flex;align-items:center;justify-content:center;background-image:radial-gradient(circle at 10% 20%,rgba(138,43,226,.3) 0,transparent 40%),radial-gradient(circle at 90% 80%,rgba(255,87,34,.3) 0,transparent 40%)}.container{max-width:800px;margin:auto;padding:.8rem;width:100%}header{background:linear-gradient(135deg,var(--primary),var(--secondary));padding:.8rem;border-radius:12px;margin-bottom:1rem;box-shadow:0 4px 20px rgba(0,0,0,.25);text-align:center;display:flex;align-items:center;justify-content:center}header i{font-size:1.5rem;margin-right:.5rem}h1{font-size:1.6rem;text-shadow:0 2px 4px rgba(0,0,0,.3)}h2{font-size:1.3rem;margin-bottom:.6rem;color:var(--primary);border-bottom:1px solid rgba(255,255,255,.1);padding-bottom:.3rem;display:flex;align-items:center}h2 i{margin-right:.5rem}.status-card{background-color:var(--card-bg);border-radius:12px;padding:1rem;margin-bottom:1rem;box-shadow:0 8px 24px rgba(0,0,0,.15);border:1px solid rgba(255,255,255,.05);backdrop-filter:blur(10px);transition:transform .3s,box-shadow .3s}.status-card:hover{transform:translateY(-5px);box-shadow:0 12px 28px rgba(0,0,0,.2)}.status-indicator{display:inline-block;padding:.4rem 1rem;border-radius:50px;font-weight:700;margin-bottom:.8rem;font-size:1.2rem;box-shadow:0 4px 8px rgba(0,0,0,.2);text-align:center}.available{background-color:var(--success);color:#fff}.unavailable{background-color:var(--danger);color:#fff}.maybe{background-color:var(--warning);color:#fff}.date-display{display:flex;align-items:center;margin-bottom:.8rem;font-weight:500}.date-display i{margin-right:.5rem;color:var(--secondary)}.time-slots{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.6rem;margin-bottom:.6rem}.time-slot{background-color:rgba(255,255,255,.1);border-radius:8px;padding:.5rem .8rem;font-size:.95rem;display:flex;align-items:center;border:1px solid rgba(255,255,255,.05);transition:background-color .2s}.time-slot:hover{background-color:rgba(255,255,255,.15)}.time-slot i{margin-right:.5rem;color:var(--secondary)}.weekly-schedule-container{overflow-x:auto;margin-top:1rem;border-radius:8px;background-color:rgba(0,0,0,.2);padding:.8rem}.weekly-schedule{display:grid;grid-template-columns:auto repeat(7,1fr);gap:.3rem;min-width:600px}.day-header{text-align:center;font-weight:700;padding:.4rem;background-color:rgba(138,43,226,.2);border-radius:5px;display:flex;flex-direction:column;align-items:center}.day-name{margin-bottom:.2rem}.day-date{font-size:.85rem;opacity:.8}.time-row{display:contents}.time-label{padding:.4rem;text-align:right;font-weight:700;display:flex;align-items:center;justify-content:flex-end}.time-label i{margin-right:.5rem;color:var(--secondary);font-size:.9rem}.schedule-cell{background-color:rgba(255,255,255,.05);border-radius:5px;padding:.4rem;text-align:center;transition:transform .2s,background-color .2s;cursor:default}.schedule-cell:hover{transform:scale(1.05)}.yes{background-color:rgba(76,175,80,.3);border:1px solid rgba(76,175,80,.5)}.yes:hover{background-color:rgba(76,175,80,.4)}.no{background-color:rgba(244,67,54,.3);border:1px solid rgba(244,67,54,.5)}.no:hover{background-color:rgba(244,67,54,.4)}.maybe{background-color:rgba(255,152,0,.3);border:1px solid rgba(255,152,0,.5)}.maybe:hover{background-color:rgba(255,152,0,.4)}.today{position:relative;border:2px solid var(--primary);box-shadow:0 0 10px rgba(138,43,226,.4)}.today::after{content:"Bugün";position:absolute;top:-10px;right:-5px;background-color:var(--primary);color:#fff;font-size:.7rem;padding:.2rem .5rem;border-radius:3px;box-shadow:0 2px 5px rgba(0,0,0,.2)}footer{text-align:center;margin-top:.5rem;padding:.8rem;color:rgba(255,255,255,.5);font-size:.9rem}.user-name{font-weight:700;color:var(--primary)}.note{margin-top:.8rem;padding:.8rem;background-color:rgba(255,255,255,.05);border-radius:8px;border-left:3px solid var(--secondary);display:flex;align-items:flex-start}.note i{margin-right:.7rem;color:var(--secondary);font-size:1.2rem;margin-top:.1rem}.info-text{margin:0 auto .6rem auto;font-style:italic;opacity:.8;display:flex;align-items:center;justify-content:center;font-size:.8rem}.info-text i{margin-right:.5rem}.status-labels{display:flex;gap:.8rem;flex-wrap:wrap;margin-top:.8rem;justify-content:center}.status-label{display:flex;align-items:center;font-size:.9rem}.status-dot{width:12px;height:12px;border-radius:50%;margin-right:.5rem}.dot-yes{background-color:rgba(76,175,80,.8)}.dot-no{background-color:rgba(244,67,54,.8)}.dot-maybe{background-color:rgba(255,152,0,.8)}.update-btn{display:block;margin:.8rem auto .4rem auto;padding:.6rem 1.2rem;background:linear-gradient(135deg,var(--primary),var(--secondary));border:none;border-radius:50px;color:#fff;font-weight:700;cursor:pointer;transition:transform .2s,box-shadow .2s;box-shadow:0 4px 10px rgba(0,0,0,.2)}.update-btn:hover{transform:translateY(-3px);box-shadow:0 6px 14px rgba(0,0,0,.3)}.update-btn i{margin-right:.5rem}.loading{display:flex;align-items:center;justify-content:center;margin:.6rem 0}.loading-spinner{border:4px solid rgba(255,255,255,.1);border-radius:50%;border-top:4px solid var(--secondary);width:24px;height:24px;animation:spin 1s linear infinite;margin-right:10px}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.time-info{background-color:rgba(255,255,255,.1);border-radius:8px;padding:.5rem .8rem;font-size:.85rem;margin-bottom:.5rem;border-left:3px solid var(--primary)}.time-info-title{font-weight:700;color:var(--primary);margin-bottom:.2rem}.time-info-hours{color:rgba(255,255,255,.7);font-style:italic}.tabs{display:flex;margin-bottom:1rem;background-color:rgba(30,30,30,.6);border-radius:50px;padding:.3rem;box-shadow:0 4px 10px rgba(0,0,0,.15)}.tab{flex:1;padding:.5rem .5rem;text-align:center;cursor:pointer;transition:all .3s;border-radius:50px;font-weight:700;color:rgba(255,255,255,.7)}.tab.active{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;box-shadow:0 4px 10px rgba(0,0,0,.2)}.tab-content{display:none}.tab-content.active{display:block}@media (max-width:768px){.container{padding:.5rem}.status-card{padding:.8rem;margin-bottom:.8rem}.weekly-schedule-container{margin-left:-.5rem;margin-right:-.5rem;border-radius:0;width:calc(100% + 1rem)}.weekly-schedule{min-width:550px}.status-indicator{width:100%;text-align:center;font-size:1.2rem;padding:.5rem}.date-display{font-size:1rem;justify-content:center;margin-bottom:.8rem}h2{font-size:1.1rem;margin-bottom:.5rem}.note{padding:.6rem;font-size:.9rem}.time-slot{padding:.4rem .6rem;font-size:.9rem}.time-slots{justify-content:center}.compact-view{font-size:.9rem}.time-row .time-label{font-size:.8rem;padding:.3rem}body{background-image:none;background-color:var(--dark)}}@media (max-width:480px){.container{padding:.5rem}header{padding:.6rem;margin-bottom:.8rem}h1{font-size:1.3rem}h2{font-size:1.1rem;margin-bottom:.4rem}.status-indicator{font-size:1.1rem;padding:.4rem .8rem;margin-bottom:.6rem}.time-slot{padding:.4rem .6rem;font-size:.85rem;width:100%}.status-labels{flex-direction:row;justify-content:space-around;gap:.3rem;font-size:.8rem}#todayDate{font-size:1rem;font-weight:700}.weekly-schedule-container::before{content:"← Görüntüyü kaydır →";display:block;text-align:center;color:rgba(255,255,255,.5);font-size:.7rem;margin-bottom:.3rem}footer{font-size:.8rem;padding:.5rem;margin-top:.5rem}header i{font-size:1.2rem}.schedule-cell{padding:.3rem;font-size:.9rem}}.highlight-today{animation:pulse 2s infinite}@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(138,43,226,.7)}70%{box-shadow:0 0 0 6px rgba(138,43,226,0)}100%{box-shadow:0 0 0 0 rgba(138,43,226,0)}}@media (max-width:480px){.tab{padding:.4rem .3rem;font-size:.85rem}}</style><div class=container><header><i class="fas fa-gamepad"></i><h1>Oyun Durumum</h1></header><div class=tabs><div class="tab active"data-tab=today>Bugün</div><div class=tab data-tab=weekly>Haftalık Durum</div></div><div class="tab-content active"id=today-content><div class="status-card highlight-today"id=todayCard><h2><i class="fas fa-calendar-day"></i> Bugün Oyunda Var mıyım?</h2><div class=status-indicator id=todayStatus><div class=loading><div class=loading-spinner></div><span>Yükleniyor...</span></div></div><div class=date-display><i class="fas fa-calendar-alt"></i> <span id=todayDate>Yükleniyor...</span></div><h3>Müsait olduğum saatler:</h3><div class=time-slots id=todayTimeSlots><div class=loading><div class=loading-spinner></div><span>Yükleniyor...</span></div></div><div class=note><i class="fas fa-comment"></i><div id=todayNote>Yükleniyor...</div></div></div></div><div class=tab-content id=weekly-content><div class=status-card><h2><i class="fas fa-calendar-week"></i> Haftalık Oyun Durumum</h2><div id=timeInfoContainer></div><div class=weekly-schedule-container><div class=weekly-schedule id=weeklySchedule><div class=loading><div class=loading-spinner></div><span>Yükleniyor...</span></div></div></div><div class=status-labels><div class=status-label><div class="status-dot dot-yes"></div><span>Oyundayım</span></div><div class=status-label><div class="status-dot dot-no"></div><span>Yokum</span></div><div class=status-label><div class="status-dot dot-maybe"></div><span>Belki</span></div></div></div></div><button class=update-btn id=updateBtn><i class="fas fa-sync-alt"></i>Verileri Güncelle</button><div class=info-text><i class="fas fa-info-circle"></i> <span id=lastUpdateInfo>Son güncelleme: Yükleniyor...</span></div><footer><p><span class=user-name>bigfiggings</span> tarafından hazırlandı | <a href=https://github.com/ahmetgzl target=_blank style=color:var(--secondary);text-decoration:none><i class="fab fa-github"></i> GitHub</a></footer></div><script>// UTC+3 (Türkiye) zaman diliminde tarih formatı oluşturma fonksiyonu
      function formatTurkishDate(date) {
        const options = {
          timeZone: "Europe/Istanbul",
          year: "numeric",
          month: "long",
          day: "numeric",
          weekday: "long",
        };

        return new Intl.DateTimeFormat("tr-TR", options).format(date);
      }

      // Kısa gün adlarını almak için
      function getShortWeekday(date) {
        const weekdays = ["Pzr", "Pts", "Salı", "Çrş", "Prş", "Cuma", "Ctesi"];
        return weekdays[date.getDay()];
      }

      // Türkiye saatine göre tarih oluşturma (UTC+3)
      function getTurkeyTime() {
        // Türkiye için UTC+3 saat farkı
        const now = new Date();

        // Tarihi Istanbul saat dilimine çevir
        const turkeyTime = new Date(
          now.toLocaleString("en-US", { timeZone: "Europe/Istanbul" })
        );
        return turkeyTime;
      }

      // Google Sheets URL ayarı
      const SHEET_URL =
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vR5OHN2UyMSoocU44cC_thnQvUUMod--0RyOhuV8kh3EWVv6vYS7Y0LgMmVlY1r9tNqVDp_VVHdtGfl/pub?gid=0&single=true&output=csv";

      // Google Sheets'ten veri çekme fonksiyonu
      // CSV verinizi çevirmek için ücretsiz bir servis kullanın
      const PROXY_URL = `https://api.allorigins.win/raw?url=${encodeURIComponent(
        SHEET_URL
      )}`;

      // Bu proxy ile veri çekme
      async function fetchGoogleSheetsData() {
        try {
          const response = await fetch(PROXY_URL);

          if (!response.ok) {
            throw new Error("Veri çekilemedi: " + response.statusText);
          }

          // CSV içeriğini al
          const csvText = await response.text();

          // CSV'yi parse et
          const rows = csvText.split("\n").filter((row) => row.trim() !== "");
          const parsedData = rows.map((row) => {
            // Virgülle ayrılmış alanları ayır
            return row
              .split(",")
              .map((field) => field.trim().replace(/^"|"$/g, ""));
          });

          return parsedData;
        } catch (error) {
          console.error("Veri çekme hatası:", error);
          return getDummyData();
        }
      }

      // Test için örnek veri
      function getDummyData() {
        return [
          ["Başlık", "Değer", "Not"],
          ["Bugün Durumu", "Müsaitim", "Bugün kesin oyundayım!"],
          ["Saat Aralığı 1", "20:00 - 22:00", ""],
          ["Saat Aralığı 2", "22:00 - 00:00", ""],
          ["Hafta Durumu", "", ""],
          ["Zaman Dilimi 1", "SABAH", "08:00 - 12:00"],
          ["Zaman Dilimi 2", "AKŞAM", "18:00 - 23:00"],
          ["Pazartesi SABAH", "evet", ""],
          ["Pazartesi AKŞAM", "evet", ""],
          ["Salı SABAH", "evet", ""],
          ["Salı AKŞAM", "evet", ""],
          ["Çarşamba SABAH", "belki", ""],
          ["Çarşamba AKŞAM", "belki", ""],
          ["Perşembe SABAH", "hayır", ""],
          ["Perşembe AKŞAM", "belki", ""],
          ["Cuma SABAH", "hayır", ""],
          ["Cuma AKŞAM", "belki", ""],
          ["Cumartesi SABAH", "belki", ""],
          ["Cumartesi AKŞAM", "belki", ""],
          ["Pazar SABAH", "belki", ""],
          ["Pazar AKŞAM", "belki", ""],
        ];
      }

      // Veriyi UI'a uygulama
      function updateUI(data) {
        if (!data || data.length < 2) {
          console.error("Geçersiz veri formatı");
          return;
        }

        // Bugün durumu
        const todayStatus = data.find((row) => row[0] === "Bugün Durumu");
        if (todayStatus) {
          const statusText = todayStatus[1];
          const statusElement = document.getElementById("todayStatus");
          statusElement.innerHTML = statusText;

          // Statüsüne göre sınıf ata
          statusElement.className = "status-indicator";
          if (statusText.toLowerCase().includes("müsait")) {
            statusElement.classList.add("available");
          } else if (statusText.toLowerCase().includes("belki")) {
            statusElement.classList.add("maybe");
          } else {
            statusElement.classList.add("unavailable");
          }

          // Not kısmını güncelle
          if (todayStatus[2]) {
            document.getElementById("todayNote").textContent = todayStatus[2];
          } else {
            document.getElementById("todayNote").textContent = "Not yok";
          }
        }

        // Saat aralıklarını temizle ve yeniden doldur
        const timeSlotsContainer = document.getElementById("todayTimeSlots");
        timeSlotsContainer.innerHTML = "";

        // Saat aralıklarını bul ve ekle
        const timeRanges = data.filter((row) =>
          row[0].includes("Saat Aralığı")
        );
        
        // Sadece değeri olan saat aralıklarını ekle
        timeRanges.forEach((timeRange) => {
          if (timeRange[1] && timeRange[1].trim() !== "") {
            const timeSlot = document.createElement("div");
            timeSlot.className = "time-slot";
            timeSlot.innerHTML = `<i class="far fa-clock"></i>${timeRange[1]}`;
            timeSlotsContainer.appendChild(timeSlot);
          }
        });

        // Eğer hiç saat aralığı yoksa bilgi mesajı göster
        if (timeSlotsContainer.children.length === 0) {
          const noTimeInfo = document.createElement("div");
          noTimeInfo.className = "time-slot";
          noTimeInfo.innerHTML = `<i class="fas fa-info-circle"></i>Belirtilen saat yok`;
          timeSlotsContainer.appendChild(noTimeInfo);
        }

        // Bugünün tarihini ayarla
        document.getElementById("todayDate").textContent = formatTurkishDate(
          getTurkeyTime()
        );

        // Zaman dilimlerini çıkar ve göster
        const timeZones = data.filter((row) => row[0].includes("Zaman Dilimi"));
        if (timeZones.length > 0) {
          updateTimeInfo(timeZones);
        }

        // Haftalık takvimi güncelle
        updateWeeklySchedule(data, timeZones);

        // Son güncelleme zamanını güncelle
        const now = getTurkeyTime();
        const options = {
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        };
        const formattedDate = new Intl.DateTimeFormat("tr-TR", options).format(
          now
        );
        document.getElementById("lastUpdateInfo").textContent =
          "Son güncelleme: " + formattedDate;
      }

      // Zaman dilimi bilgilerini güncelleme
      function updateTimeInfo(timeZones) {
        const container = document.getElementById("timeInfoContainer");
        container.innerHTML = "";

        timeZones.forEach((zone) => {
          const infoBox = document.createElement("div");
          infoBox.className = "time-info";

          let content = `<div class="time-info-title">${zone[1]}</div>`;
          if (zone[2]) {
            content += `<div class="time-info-hours">${zone[2]}</div>`;
          }

          infoBox.innerHTML = content;
          container.appendChild(infoBox);
        });
      }

      // Haftalık takvimi güncelleme fonksiyonu
      function updateWeeklySchedule(data, timeZones) {
        const weeklySchedule = document.getElementById("weeklySchedule");

        // Başlık satırını temizleme
        weeklySchedule.innerHTML = "";

        // Boş başlık ekleme
        const emptyHeader = document.createElement("div");
        emptyHeader.className = "day-header";
        weeklySchedule.appendChild(emptyHeader);

        // Haftanın günlerini oluşturma
        const today = getTurkeyTime();
        const currentDay = today.getDay(); // 0: Pazar, 1: Pazartesi, ...
        const dayNumbers = [];

        // Pazartesiden Pazara sıralı gün isimleri (TR formatı)
        const dayNames = ["Pts", "Salı", "Çrş", "Prş", "Cuma", "Ctesi", "Pzr"];

        // Pazartesiden başlayan gün indeksleri (1: Pazartesi, ..., 0: Pazar)
        const dayIndices = [1, 2, 3, 4, 5, 6, 0];

        // İçinde bulunduğumuz haftanın pazartesiden pazara 7 gününü hesaplama
        for (let i = 0; i < 7; i++) {
          // Hesaplanan gün
          const date = new Date(today);

          // Pazartesi = 1, Salı = 2, ..., Pazar = 0 olduğundan
          // Pazartesi'ye göre kaç gün fark var hesaplama
          const dayDiff = (currentDay === 0 ? -6 : 1 - currentDay) + i;
          date.setDate(date.getDate() + dayDiff);

          dayNumbers.push({
            dayName: dayNames[i],
            dayNumber: date.getDate(),
            isToday:
              date.getDate() === today.getDate() &&
              date.getMonth() === today.getMonth() &&
              date.getFullYear() === today.getFullYear(),
          });
        }

        // Günleri takvime ekleme
        dayNumbers.forEach((day, index) => {
          const dayHeader = document.createElement("div");
          dayHeader.className = "day-header" + (day.isToday ? " today" : "");
          dayHeader.id = "day" + index;

          const dayNameSpan = document.createElement("span");
          dayNameSpan.className = "day-name";
          dayNameSpan.textContent = day.dayName;

          const dayDateSpan = document.createElement("span");
          dayDateSpan.className = "day-date";
          dayDateSpan.textContent = day.dayNumber;

          dayHeader.appendChild(dayNameSpan);
          dayHeader.appendChild(dayDateSpan);
          weeklySchedule.appendChild(dayHeader);
        });

        // Tam gün isimleri - Pazartesiden Pazara
        const fullDayNames = [
          "Pazartesi",
          "Salı",
          "Çarşamba",
          "Perşembe",
          "Cuma",
          "Cumartesi",
          "Pazar",
        ];

        // Zaman dilimlerinden dinamik olarak satırları oluştur
        if (timeZones && timeZones.length > 0) {
          timeZones.forEach((zone) => {
            const timeRow = document.createElement("div");
            timeRow.className = "time-row";

            // Zaman etiketi
            const timeLabel = document.createElement("div");
            timeLabel.className = "time-label";
            timeLabel.innerHTML = `<i class="far fa-clock"></i>${zone[1]}`;
            weeklySchedule.appendChild(timeLabel);

            // Her gün için hücreler
            for (let i = 0; i < 7; i++) {
              const scheduleCell = document.createElement("div");

              // Google Sheets'ten durumu bul
              const dayName = fullDayNames[i];
              const timeIdentifier = zone[1];
              const cellDataRow = data.find(
                (row) => row[0] === `${dayName} ${timeIdentifier}`
              );

              let cellStatus = "maybe"; // Varsayılan durum
              let statusSymbol = "?";

              if (cellDataRow) {
                const status = cellDataRow[1].toLowerCase();
                if (status === "evet") {
                  cellStatus = "yes";
                  statusSymbol = "✓";
                } else if (status === "hayır") {
                  cellStatus = "no";
                  statusSymbol = "✗";
                }
              }

              scheduleCell.className = `schedule-cell ${cellStatus}`;
              scheduleCell.setAttribute("data-day", dayIndices[i]);
              scheduleCell.setAttribute("data-time", timeIdentifier);
              scheduleCell.textContent = statusSymbol;

              weeklySchedule.appendChild(scheduleCell);
            }
          });
        } else {
          // Varsayılan zaman dilimleri
          const defaultTimeSlots = [
            { label: "18-20", time: "1800" },
            { label: "20-24", time: "2000" },
          ];

          defaultTimeSlots.forEach((slot) => {
            const timeRow = document.createElement("div");
            timeRow.className = "time-row";

            // Zaman etiketi
            const timeLabel = document.createElement("div");
            timeLabel.className = "time-label";
            timeLabel.innerHTML = `<i class="far fa-clock"></i>${slot.label}`;
            weeklySchedule.appendChild(timeLabel);

            // Her gün için hücreler
            for (let i = 0; i < 7; i++) {
              const scheduleCell = document.createElement("div");

              // Varsayılan durum
              let cellStatus = i < 2 ? "yes" : "maybe";
              let statusSymbol = cellStatus === "yes" ? "✓" : "?";

              scheduleCell.className = `schedule-cell ${cellStatus}`;
              scheduleCell.setAttribute("data-day", dayIndices[i]);
              scheduleCell.setAttribute("data-time", slot.time);
              scheduleCell.textContent = statusSymbol;

              weeklySchedule.appendChild(scheduleCell);
            }
          });
        }
      }

      // Tab değiştirme
      function setupTabs() {
        const tabs = document.querySelectorAll('.tab');
        
        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            // Tüm tabları pasif yap
            tabs.forEach(t => t.classList.remove('active'));
            
            // Tüm içerikleri gizle
            document.querySelectorAll('.tab-content').forEach(content => {
              content.classList.remove('active');
            });
            
            // Seçili tabı aktif yap
            tab.classList.add('active');
            
            // İlgili içeriği göster
            const tabId = tab.getAttribute('data-tab');
            document.getElementById(`${tabId}-content`).classList.add('active');
          });
        });
      }

      // Verileri yükle ve UI'ı güncelle
      async function loadData() {
        try {
          const data = await fetchGoogleSheetsData();
          updateUI(data);
        } catch (error) {
          console.error("Veri yükleme hatası:", error);
          alert("Veriler yüklenirken bir hata oluştu: " + error.message);
        }
      }

      // Sayfa yüklendiğinde çalışacak
      document.addEventListener("DOMContentLoaded", function () {
        // Tab sistemini kur
        setupTabs();
        
        // Tarih ve saat bilgilerini başlat
        const today = getTurkeyTime();
        document.getElementById("todayDate").textContent =
          formatTurkishDate(today);

        // Verileri yükle
        loadData();

        // Güncelleme butonuna tıklandığında
        document
          .getElementById("updateBtn")
          .addEventListener("click", function () {
            // Yükleme animasyonunu göster
            document.getElementById("todayStatus").innerHTML =
              '<div class="loading"><div class="loading-spinner"></div><span>Yükleniyor...</span></div>';
            document.getElementById("todayTimeSlots").innerHTML =
              '<div class="loading"><div class="loading-spinner"></div><span>Yükleniyor...</span></div>';
            document.getElementById("weeklySchedule").innerHTML =
              '<div class="loading"><div class="loading-spinner"></div><span>Yükleniyor...</span></div>';

            // Verileri yeniden yükle
            loadData();
          });
      });</script>